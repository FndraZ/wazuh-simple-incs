# Unix service account creation
field_order: ["dstuser", "host"]

extract_rules:
  dstuser: "data.dstuser" 
  host: "predecoder.hostname"

notification_extract_rules:
  username: "data.dstuser" 
  host: "predecoder.hostname"
  uid: "data.uid"

fir:
  subject: "Service account created on {host}: {username} (UID: {uid})"
  
  description_template: |
    ## Service Account Creation Detected
    **Time:** {timestamp}
    **Alert ID:** {alert_id}
    
    **Host:** {host}
    **Created User:** {username}
    **User ID:** {uid}
        
    ### Investigation Steps
    1. Determine which application/service requires this account.
    2. Review account permissions and file ownerships.
    3. Validate with system administrators if this was planned.
    
  severity: 2
  category: "Service Account Management"