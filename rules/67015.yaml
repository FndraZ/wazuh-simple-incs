# delete task
field_order: ["host", "task"]

extract_rules:
  host: "data.win.system.computer"
  task: "data.win.eventdata.taskName" 

notification_extract_rules:
  host: "data.win.system.computer"
  task: "data.win.eventdata.taskName"
  user: "data.win.eventdata.userName"

fir:
  subject: "Task {task} was created and deleted within 24h on {host}"
  
  description_template: |
    # Suspicious Scheduled Task Activity
    **Task was created and deleted within 24 hours.**

    # Deletion Event:
    - **Time:** {timestamp}
    - **Alert ID:** {alert_id}
    
    # Task Details:
    - **Hostname:** {host}
    - **Task Name:** {task}
    - **Username:** {user}
    
    # Investigation Actions:
    1. Find the creation event of this scheduled task (Event ID: 106)
    2. Identify the source: user account and creation process
    3. If the task was created by an application, verify its legitimacy
    4. Check if similar tasks exist on other hosts
    5. Review task scheduler history for anomalies

    
  severity: 1
  category: "Create and delete task within 24h" # ALWAYS NEED TO DEFINE IT IN FIR