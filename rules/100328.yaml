# RAT DETECTION - WINDOWS
# FIELDS FOR EXCL
field_order: ["process_name", "hostname", "user"]

extract_rules:
  process_name: "data.win.eventdata.newProcessName"
  hostname: "data.computer_name"
  user: "data.win.eventdata.user"

# FIELDS FOR ALERT FIR
notification_extract_rules:
  rat_name: "data.win.eventdata.newProcessName"
  host: "data.computer_name"
  user: "data.win.eventdata.user"

# FIR CONF
fir:
  subject: "RAT: {rat_name} on {host}"
  
  description_template: |
    ## Remote Access Trojan (RAT) Detected - Windows
    **Time:** {timestamp}
    **Alert ID:** {alert_id}
    
    **RAT Name:** {rat_name}
    **Host:** {host}
    **User:** {user}
    
    ### Investigation Steps
    1. Analyze execution time delta and check for persistence mechanisms.
    2. Search for outbound C2 connections from this host (network logs).
    3. Check for inbound connections if RAT has server component.
    4. Look for dropped payloads and lateral movement artifacts.
    
  severity: 1
  category: "RAT Activity"