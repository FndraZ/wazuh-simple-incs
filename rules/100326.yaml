# HACKTOOL DETECTION - WINDOWS
# FIELDS FOR EXCL
field_order: ["process_name", "hostname", "user"]

extract_rules:
  process_name: "data.win.eventdata.newProcessName"
  hostname: "data.computer_name"
  user: "data.win.eventdata.user"

# FIELDS FOR ALERT FIR
notification_extract_rules:
  malicious_process: "data.win.eventdata.newProcessName"
  host: "data.computer_name"
  executed_by: "data.win.eventdata.user"

# FIR CONF
fir:
  subject: "Hacktool: {malicious_process} on {host}"
  
  description_template: |
    ## Hacktool Detected on Windows Host
    **Time:** {timestamp}
    **Alert ID:** {alert_id}
    
    **Tool:** {malicious_process}
    **Host:** {host}
    **User:** {executed_by}
    
    ### Investigation Steps
    1. Analyze execution time delta.
    2. Search for inbound/outbound connections from this host around execution time.
    3. Check for associated payloads/downloads in file system.
    
  severity: 1
  category: "Malicious Tools Execution"